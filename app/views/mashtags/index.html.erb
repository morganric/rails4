

    <!-- Main jumbotron for a primary marketing message or call to action -->
    <div class="jumbotron">
      <div class="container">
       <h1>#MashTag</h1>
       <div cass="row">
          <div class="col-sm-3">
       
            <p>Enter a Mixcloud username below for a mashup tagcloud of the music they love...</p>
                mixcloud.com/<input type="text" id="username" label="mixcloud username" placeholder="" value="<%= @mashtag.user_name %>" />
                <br/><br/>
                  <button id="submit-button" name="Tag me" class="btn btn-primary">#MashMeUp</button>

                <br/>
                <%= @mashtag.facebook_page_id %>
                <% if  @signed_request != nil %><%= @signed_request["page"]["id"] %><% end %>
                <br/>

                 <p class="fb-button" ><button id="connect" class="btn btn-small"><i class="icon icon-fb" ></i>Add Tab to Facebook Page</button>  </p>              
          </div>
          <div class="col-sm-9" >
            <div id="cloud-wrap" >
            <div id="cloud" style="width: 600px; height: 400px;"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div id="fb-root"></div>

      <hr>

    </div> <!-- /container -->        

        <script>
          window.fbAsyncInit = function() {
            FB.init({
              appId      : '1412697118982924',
              status     : true,
              xfbml      : true
            });

            // Facebook JS UI here
            $("#connect").on("click", function() {

                  FB.ui({
                  method: 'pagetab',
                  redirect_uri: 'https://apps.facebook.com/mashtag/'
                }, function(response){

                  var mashtag = $('#username').val();
                  var page_id = Object.keys(response.tabs_added)[0];

                  $.ajax({
                  type: "POST",
                  url: "/mashtags/facebook",
                  data: { facebook_page_tab: { user_name: mashtag, facebook_page_id: page_id } },
                  success: function() {
                    console.log('success');
                            },
                  dataType: "jsonp"
                });




                });

             });

            
          };

          (function(d, s, id){
             var js, fjs = d.getElementsByTagName(s)[0];
             if (d.getElementById(id)) {return;}
             js = d.createElement(s); js.id = id;
             js.src = "//connect.facebook.net/en_US/all.js";
             fjs.parentNode.insertBefore(js, fjs);
           }(document, 'script', 'facebook-jssdk'));
        </script> 

        <script>
            var _gaq=[['_setAccount','UA-XXXXX-X'],['_trackPageview']];
            (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
            g.src='//www.google-analytics.com/ga.js';
            s.parentNode.insertBefore(g,s)}(document,'script'));
        </script>
    </body>
</html>



